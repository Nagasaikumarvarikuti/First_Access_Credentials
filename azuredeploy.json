{
    "$schema":  "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion":  "1.0.0.0",
    "metadata":  {
        "title":  "",
        "description":  "",
        "prerequisites":  "",
        "postDeployment":  [
        ],
        "prerequisitesDeployTemplateFile":  "",
        "lastUpdateTime":  "",
        "entities":  [
        ],
        "tags":  [
        ],
        "support":  {
            "tier":  "community",
            "armtemplate":  "Generated from https://github.com/Azure/Azure-Sentinel/tree/master/Tools/Playbook-ARM-Template-Generator"
        },
        "author":  {
            "name":  ""
        }
    },
    "parameters":  {
        "PlaybookName":  {
            "defaultValue":  "First_Access_Credential",
            "type":  "string"
        }
    },
    "variables":  {
        "MicrosoftSentinelConnectionName":  "[concat('MicrosoftSentinel-', parameters('PlaybookName'))]",
        "Azuresentinel-1ConnectionName":  "[concat('Azuresentinel-1-', parameters('PlaybookName'))]",
        "OutlookConnectionName":  "[concat('Outlook-', parameters('PlaybookName'))]",
        "Azuresentinel-2ConnectionName":  "[concat('Azuresentinel-2-', parameters('PlaybookName'))]",
        "AzuremonitorlogsConnectionName":  "[concat('Azuremonitorlogs-', parameters('PlaybookName'))]"
    },
    "resources":  [
        {
            "properties":  {
                "provisioningState":  "Succeeded",
                "state":  "Enabled",
                "definition":  {
                    "$schema":  "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                    "contentVersion":  "1.0.0.0",
                    "parameters":  {
                        "$connections":  {
                            "defaultValue":  {
                            },
                            "type":  "Object"
                        }
                    },
                    "triggers":  {
                        "Microsoft_Sentinel_incident":  {
                            "type":  "ApiConnectionWebhook",
                            "inputs":  {
                                "host":  {
                                    "connection":  {
                                        "name":  "@parameters('$connections')['azuresentinel']['connectionId']"
                                    }
                                },
                                "body":  {
                                    "callback_url":  "@{listCallbackUrl()}"
                                },
                                "path":  "/incident-creation"
                            }
                        }
                    },
                    "actions":  {
                        "Entities_-_Get_IPs":  {
                            "runAfter":  {
                            },
                            "type":  "ApiConnection",
                            "inputs":  {
                                "host":  {
                                    "connection":  {
                                        "name":  "@parameters('$connections')['azuresentinel-1']['connectionId']"
                                    }
                                },
                                "method":  "post",
                                "body":  "@triggerBody()?['object']?['properties']?['relatedEntities']",
                                "path":  "/entities/ip"
                            }
                        },
                        "Clean_IPs":  {
                            "runAfter":  {
                                "Entities_-_Get_IPs":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "Clean_IP",
                                        "type":  "string",
                                        "value":  "\u003ctable style=\"border: 1px solid black; border-collapse: collapse; display: inline-table; width: auto;\"\u003e\u003ctr style=\"border: 1px solid black;\"\u003e\u003cth style=\"border: 1px solid black;\"\u003eIP Address\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eReputation\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eTags\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eCountry\u003c/th\u003e\u003c/tr\u003e"
                                    }
                                ]
                            }
                        },
                        "Malicious_IPs":  {
                            "runAfter":  {
                                "Clean_IPs":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "Malicious_IP",
                                        "type":  "string",
                                        "value":  "\u003ctable style=\"border: 1px solid black; border-collapse: collapse; display: inline-table; width: auto;\"\u003e\u003ctr style=\"border: 1px solid black;\"\u003e\u003cth style=\"border: 1px solid black;\"\u003eIP Address\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eReputation\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eTags\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eCountry\u003c/th\u003e\u003c/tr\u003e"
                                    }
                                ]
                            }
                        },
                        "For_each":  {
                            "foreach":  "@body('Entities_-_Get_IPs')?['IPs']",
                            "actions":  {
                                "HTTP":  {
                                    "type":  "Http",
                                    "inputs":  {
                                        "uri":  "https://virustotal.com/api/v3/ip_addresses/@{item()?['Address']}",
                                        "method":  "GET",
                                        "headers":  {
                                            "x-apikey":  "8488692f9c402caac50ad7d7bd471d8d546a6f7a48498ffa0ed3176464fcab4e"
                                        }
                                    },
                                    "runtimeConfiguration":  {
                                        "contentTransfer":  {
                                            "transferMode":  "Chunked"
                                        }
                                    }
                                },
                                "Parse_JSON":  {
                                    "runAfter":  {
                                        "HTTP":  [
                                            "Succeeded"
                                        ]
                                    },
                                    "type":  "ParseJson",
                                    "inputs":  {
                                        "content":  "@body('HTTP')",
                                        "schema":  {
                                            "type":  "object",
                                            "properties":  {
                                                "data":  {
                                                    "type":  "object",
                                                    "properties":  {
                                                        "id":  {
                                                            "type":  "string"
                                                        },
                                                        "type":  {
                                                            "type":  "string"
                                                        },
                                                        "links":  {
                                                            "type":  "object",
                                                            "properties":  {
                                                                "self":  {
                                                                    "type":  "string"
                                                                }
                                                            }
                                                        },
                                                        "attributes":  {
                                                            "type":  "object",
                                                            "properties":  {
                                                                "network":  {
                                                                    "type":  "string"
                                                                },
                                                                "total_votes":  {
                                                                    "type":  "object",
                                                                    "properties":  {
                                                                        "harmless":  {
                                                                            "type":  "integer"
                                                                        },
                                                                        "malicious":  {
                                                                            "type":  "integer"
                                                                        }
                                                                    }
                                                                },
                                                                "reputation":  {
                                                                    "type":  "integer"
                                                                },
                                                                "continent":  {
                                                                    "type":  "string"
                                                                },
                                                                "regional_internet_registry":  {
                                                                    "type":  "string"
                                                                },
                                                                "as_owner":  {
                                                                    "type":  "string"
                                                                },
                                                                "last_analysis_results":  {
                                                                    "type":  "object",
                                                                    "properties":  {
                                                                        "Acronis":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "0xSI_f33d":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Abusix":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "ADMINUSLabs":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Axur":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Criminal IP":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "AILabs (MONITORAPP)":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "AlienVault":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "alphaMountain.ai":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "AlphaSOC":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Antiy-AVL":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "ArcSight Threat Intelligence":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "AutoShun":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "benkow.cc":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Bfore.Ai PreCrime":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "BitDefender":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Bkav":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Blueliv":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Certego":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Chong Lua Dao":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "CINS Army":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Cluster25":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "CRDF":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "CSIS Security Group":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Snort IP sample list":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "CMC Threat Intelligence":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Cyan":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Cyble":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "CyRadar":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "DNS8":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Dr.Web":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Ermes":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "ESET":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "ESTsecurity":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "EmergingThreats":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Emsisoft":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Forcepoint ThreatSeeker":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Fortinet":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "G-Data":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "GCP Abuse Intelligence":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Google Safebrowsing":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "GreenSnow":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Gridinsoft":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Heimdal Security":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Hunt.io Intelligence":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "IPsum":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Juniper Networks":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Kaspersky":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Lionic":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Lumu":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "MalwarePatrol":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "MalwareURL":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Malwared":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Netcraft":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "OpenPhish":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Phishing Database":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "PhishFort":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "PhishLabs":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Phishtank":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "PREBYTES":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "PrecisionSec":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Quick Heal":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Quttera":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "SafeToOpen":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Sansec eComscan":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Scantitan":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "SCUMWARE.org":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Seclookup":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "SecureBrain":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Segasec":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "SOCRadar":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Sophos":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Spam404":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "StopForumSpam":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Sucuri SiteCheck":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "ThreatHive":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Threatsourcing":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Trustwave":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Underworld":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "URLhaus":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "URLQuery":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Viettel Threat Intelligence":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "VIPRE":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "VX Vault":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "ViriBack":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Webroot":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Yandex Safebrowsing":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "ZeroCERT":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "desenmascara.me":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "malwares.com URL checker":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "securolytics":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "Xcitium Verdict Cloud":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "zvelo":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        },
                                                                        "ZeroFox":  {
                                                                            "type":  "object",
                                                                            "properties":  {
                                                                                "method":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "engine_name":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "category":  {
                                                                                    "type":  "string"
                                                                                },
                                                                                "result":  {
                                                                                    "type":  "string"
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                },
                                                                "tags":  {
                                                                    "type":  "array"
                                                                },
                                                                "asn":  {
                                                                    "type":  "integer"
                                                                },
                                                                "last_analysis_stats":  {
                                                                    "type":  "object",
                                                                    "properties":  {
                                                                        "malicious":  {
                                                                            "type":  "integer"
                                                                        },
                                                                        "suspicious":  {
                                                                            "type":  "integer"
                                                                        },
                                                                        "undetected":  {
                                                                            "type":  "integer"
                                                                        },
                                                                        "harmless":  {
                                                                            "type":  "integer"
                                                                        },
                                                                        "timeout":  {
                                                                            "type":  "integer"
                                                                        }
                                                                    }
                                                                },
                                                                "country":  {
                                                                    "type":  "string"
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                },
                                "Condition":  {
                                    "actions":  {
                                        "Malicious_IP":  {
                                            "type":  "AppendToStringVariable",
                                            "inputs":  {
                                                "name":  "Malicious_IP",
                                                "value":  "\u003ctr\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()?['Address']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{body('Parse_JSON')?['data']?['attributes']?['last_analysis_stats']?['malicious']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{body('Parse_JSON')?['data']?['attributes']?['tags']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{body('Parse_JSON')?['data']?['attributes']?['country']}\u003c/td\u003e\u003c/tr\u003e"
                                            }
                                        }
                                    },
                                    "runAfter":  {
                                        "Parse_JSON":  [
                                            "Succeeded"
                                        ]
                                    },
                                    "else":  {
                                        "actions":  {
                                            "CleanIP":  {
                                                "type":  "AppendToStringVariable",
                                                "inputs":  {
                                                    "name":  "Clean_IP",
                                                    "value":  "\u003ctr\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()?['Address']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{body('Parse_JSON')?['data']?['attributes']?['total_votes']?['malicious']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{body('Parse_JSON')?['data']?['attributes']?['tags']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{body('Parse_JSON')?['data']?['attributes']?['country']}\u003c/td\u003e\u003c/tr\u003e"
                                                }
                                            }
                                        }
                                    },
                                    "expression":  {
                                        "and":  [
                                            {
                                                "greaterOrEquals":  [
                                                    "@body('Parse_JSON')?['data']?['attributes']?['last_analysis_stats']?['malicious']",
                                                    3
                                                ]
                                            }
                                        ]
                                    },
                                    "type":  "If"
                                }
                            },
                            "runAfter":  {
                                "Malicious_IPs":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "Foreach"
                        },
                        "Condition_1":  {
                            "actions":  {
                                "Send_an_email_(V2)":  {
                                    "runAfter":  {
                                        "Add_comment_to_incident_(V3)":  [
                                            "Succeeded"
                                        ]
                                    },
                                    "type":  "ApiConnection",
                                    "inputs":  {
                                        "host":  {
                                            "connection":  {
                                                "name":  "@parameters('$connections')['outlook']['connectionId']"
                                            }
                                        },
                                        "method":  "post",
                                        "body":  {
                                            "To":  "skhidaytulla0@gmail.com",
                                            "Subject":  "Need to block malicious IPs",
                                            "Body":  "\u003cp class=\"editor-paragraph\"\u003eHi Team,\u003cbr\u003eGood day!\u003cbr\u003e\u003cbr\u003eThis is an automated email triggered by Azure Logic Apps when an alert \"@{triggerBody()?['object']?['properties']?['title']}\" was trigged. Checked involved IPs reputation in threat intel tools, they are marked malicious by various vendors. Please find the below table for more details.\u003cbr\u003e@{variables('Malicious_IP')}\u003cbr\u003eKindly review the details and proceed with blocking the IPs in defender and Firewall.\u003cbr\u003e\u003cbr\u003eRegards,\u003cbr\u003eAzure Logic Apps.\u003c/p\u003e",
                                            "Importance":  "Normal"
                                        },
                                        "path":  "/v2/Mail"
                                    }
                                },
                                "Add_comment_to_incident_(V3)":  {
                                    "type":  "ApiConnection",
                                    "inputs":  {
                                        "host":  {
                                            "connection":  {
                                                "name":  "@parameters('$connections')['azuresentinel-2']['connectionId']"
                                            }
                                        },
                                        "method":  "post",
                                        "body":  {
                                            "incidentArmId":  "@triggerBody()?['object']?['id']",
                                            "message":  "\u003cp class=\"editor-paragraph\"\u003eHi Team,\u003cbr\u003eThis is an automated message. Alert \"@{triggerBody()?['object']?['properties']?['title']}\" was triggered. Checked Involved IPs repuration, in threat Intel tools, few are malcious and need to blocked at firewall and defenders end, Sent an email to SOC DL for the same, Hence please review the details and proceed for blocking. Please refer the below table for IP and reputation details.\u003cbr\u003e@{variables('Malicious_IP')}\u003c/p\u003e"
                                        },
                                        "path":  "/Incidents/Comment"
                                    }
                                }
                            },
                            "runAfter":  {
                                "For_each":  [
                                    "Succeeded"
                                ]
                            },
                            "else":  {
                                "actions":  {
                                    "Add_comment_to_incident_(V3)-CleanIP":  {
                                        "type":  "ApiConnection",
                                        "inputs":  {
                                            "host":  {
                                                "connection":  {
                                                    "name":  "@parameters('$connections')['azuresentinel-2']['connectionId']"
                                                }
                                            },
                                            "method":  "post",
                                            "body":  {
                                                "incidentArmId":  "@triggerBody()?['object']?['id']",
                                                "message":  "\u003cp class=\"editor-paragraph\"\u003eHi Team,\u003cbr\u003eThis is an automated comment. Alert \"@{triggerBody()?['object']?['properties']?['title']}\" was triggered associted with incident number @{triggerBody()?['object']?['properties']?['incidentNumber']}.\u003cbr\u003eChecked involved IPs reputation in threat intel tools, they are clean. Please refer to the below table for more details.\u003cbr\u003e@{variables('Clean_IP')}\u003c/p\u003e\u003cbr\u003e"
                                            },
                                            "path":  "/Incidents/Comment"
                                        }
                                    }
                                }
                            },
                            "expression":  {
                                "and":  [
                                    {
                                        "greater":  [
                                            "@length(split(variables('Malicious_IP'), '\u003ctr\u003e'))",
                                            2
                                        ]
                                    }
                                ]
                            },
                            "type":  "If"
                        },
                        "Entities_-_Get_Accounts":  {
                            "runAfter":  {
                                "Condition_1":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "ApiConnection",
                            "inputs":  {
                                "host":  {
                                    "connection":  {
                                        "name":  "@parameters('$connections')['azuresentinel-2']['connectionId']"
                                    }
                                },
                                "method":  "post",
                                "body":  "@triggerBody()?['object']?['properties']?['relatedEntities']",
                                "path":  "/entities/account"
                            }
                        },
                        "Sign_in":  {
                            "runAfter":  {
                                "Entities_-_Get_Accounts":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "Sign_in",
                                        "type":  "string",
                                        "value":  "\u003ctable style=\"border: 1px solid black; border-collapse: collapse; display: inline-table; width: auto;\"\u003e\u003ctr style=\"border: 1px solid black;\"\u003e\u003cth style=\"border: 1px solid black;\"\u003eUser Principle Name\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eIP Address\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eApp Display Name\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eDevice\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eTrust Type\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eLocation\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eAuthentication\u003c/th\u003e\u003c/tr\u003e"
                                    }
                                ]
                            }
                        },
                        "For_each_1":  {
                            "foreach":  "@body('Entities_-_Get_Accounts')?['Accounts']",
                            "actions":  {
                                "For_each_2":  {
                                    "foreach":  "@body('Entities_-_Get_IPs')?['IPs']",
                                    "actions":  {
                                        "sign-in_logs":  {
                                            "type":  "ApiConnection",
                                            "inputs":  {
                                                "host":  {
                                                    "connection":  {
                                                        "name":  "@parameters('$connections')['azuremonitorlogs']['connectionId']"
                                                    }
                                                },
                                                "method":  "post",
                                                "body":  "SigninLogs\n| where TimeGenerated \u003e= ago(30d)\n| where UserPrincipalName contains \"@{items('for_each_1')?['displayName']}\"\n| where IPAddress == \"@{item()?['Address']}\"\n| extend DeviceDetail = todynamic(DeviceDetail), Device = tostring(DeviceDetail.displayName)\n| extend Device = coalesce(Device, \"PII-DataRemoved\")\n| extend Trusttype = tostring(iff(DeviceDetail.trustType in ('Hybrid Azure AD joined', 'Azure AD joined', 'Azure AD registered'), \"managed device\", \"unknown device\"))\n| summarize arg_max(TimeGenerated, *) by IPAddress, UserPrincipalName\n| project TimeGenerated, UserPrincipalName, IPAddress,AppDisplayName,Device, Trusttype,Location, AuthenticationRequirement",
                                                "path":  "/queryData",
                                                "queries":  {
                                                    "subscriptions":  "8457a4da-dd02-4331-928d-10240983210a",
                                                    "resourcegroups":  "Sentinel",
                                                    "resourcetype":  "Log Analytics Workspace",
                                                    "resourcename":  "Sentinel",
                                                    "timerange":  "@triggerBody()?['object']?['properties']?['createdTimeUtc']"
                                                }
                                            }
                                        },
                                        "Condition_2":  {
                                            "actions":  {
                                                "Parse_JSON1":  {
                                                    "type":  "ParseJson",
                                                    "inputs":  {
                                                        "content":  "@body('sign-in_logs')?['value']",
                                                        "schema":  {
                                                            "type":  "array",
                                                            "items":  {
                                                                "type":  "object",
                                                                "properties":  {
                                                                    "TimeGenerated":  {
                                                                        "type":  "string"
                                                                    },
                                                                    "UserPrincipalName":  {
                                                                        "type":  "string"
                                                                    },
                                                                    "IPAddress":  {
                                                                        "type":  "string"
                                                                    },
                                                                    "AppDisplayName":  {
                                                                        "type":  "string"
                                                                    },
                                                                    "Device":  {
                                                                        "type":  "string"
                                                                    },
                                                                    "Trusttype":  {
                                                                        "type":  "string"
                                                                    },
                                                                    "Location":  {
                                                                        "type":  "string"
                                                                    },
                                                                    "AuthenticationRequirement":  {
                                                                        "type":  "string"
                                                                    }
                                                                },
                                                                "required":  [
                                                                    "TimeGenerated",
                                                                    "UserPrincipalName",
                                                                    "IPAddress",
                                                                    "AppDisplayName",
                                                                    "Device",
                                                                    "Trusttype",
                                                                    "Location",
                                                                    "AuthenticationRequirement"
                                                                ]
                                                            }
                                                        }
                                                    }
                                                },
                                                "For_each_3":  {
                                                    "foreach":  "@outputs('Parse_JSON1')['body']",
                                                    "actions":  {
                                                        "Append_Sign_in_logs":  {
                                                            "type":  "AppendToStringVariable",
                                                            "inputs":  {
                                                                "name":  "Sign_in",
                                                                "value":  "\u003ctr\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{items('For_each_3')['UserPrincipalName']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()['IPAddress']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()['AppDisplayName']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()['Device']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()['Trusttype']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()['Location']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()['AuthenticationRequirement']}\u003c/td\u003e\n\u003c/tr\u003e"
                                                            }
                                                        }
                                                    },
                                                    "runAfter":  {
                                                        "Parse_JSON1":  [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type":  "Foreach"
                                                }
                                            },
                                            "runAfter":  {
                                                "sign-in_logs":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "else":  {
                                                "actions":  {
                                                    "Append_No_Sign_in":  {
                                                        "type":  "AppendToStringVariable",
                                                        "inputs":  {
                                                            "name":  "No_Sign_in",
                                                            "value":  "\u003ctr\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{items('for_each_1')?['displayName']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003eNo Sign in observed with this IP\u003c/td\u003e\u003c/tr\u003e"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "greater":  [
                                                            "@length(body('sign-in_logs')?['value'])",
                                                            0
                                                        ]
                                                    },
                                                    {
                                                        "equals":  [
                                                            "@items('For_each_1')?['DisplayName']",
                                                            "@items('For_each_2')?['AccountName']"
                                                        ]
                                                    },
                                                    {
                                                        "equals":  [
                                                            "@item()?['Address']",
                                                            "@outputs('sign-in_logs')?['IPAddress']"
                                                        ]
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        }
                                    },
                                    "type":  "Foreach"
                                },
                                "Audit_Logs":  {
                                    "runAfter":  {
                                        "For_each_2":  [
                                            "Succeeded"
                                        ]
                                    },
                                    "type":  "ApiConnection",
                                    "inputs":  {
                                        "host":  {
                                            "connection":  {
                                                "name":  "@parameters('$connections')['azuremonitorlogs']['connectionId']"
                                            }
                                        },
                                        "method":  "post",
                                        "body":  "AuditLogs\n| where TimeGenerated \u003e= ago(30d)\n| where OperationName contains \"Certificates and secrets management\"\n| extend userdetails = parse_json(InitiatedBy)\n| extend UserName = tostring(userdetails.user.userPrincipalName)\n| extend App = parse_json(TargetResources)\n| mv-expand App\n| extend AppName = tostring(App.displayName), Type= tostring(App.type)\n| where UserName contains \"@{item()?['Name']}\"\n| project UserName,OperationName,Category, AppName, Type,Result",
                                        "path":  "/queryData",
                                        "queries":  {
                                            "subscriptions":  "8457a4da-dd02-4331-928d-10240983210a",
                                            "resourcegroups":  "Sentinel",
                                            "resourcetype":  "Log Analytics Workspace",
                                            "resourcename":  "Sentinel",
                                            "timerange":  "@triggerBody()?['object']?['properties']?['createdTimeUtc']"
                                        }
                                    }
                                },
                                "Condition_2-copy":  {
                                    "actions":  {
                                        "For_each_4":  {
                                            "foreach":  "@body('Parse_Audit_Logs')",
                                            "actions":  {
                                                "Append_Audit_logs":  {
                                                    "type":  "AppendToStringVariable",
                                                    "inputs":  {
                                                        "name":  "Audit Logs",
                                                        "value":  "\u003ctr\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()['UserName']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()['OperationName']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()['Category']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()['AppName']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()['Type']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()['Result']}\u003c/td\u003e\n\u003c/tr\u003e"
                                                    }
                                                }
                                            },
                                            "runAfter":  {
                                                "Parse_Audit_Logs":  [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type":  "Foreach"
                                        },
                                        "Parse_Audit_Logs":  {
                                            "type":  "ParseJson",
                                            "inputs":  {
                                                "content":  "@body('Audit_Logs')?['value']",
                                                "schema":  {
                                                    "type":  "array",
                                                    "items":  {
                                                        "type":  "object",
                                                        "properties":  {
                                                            "UserName":  {
                                                                "type":  "string"
                                                            },
                                                            "OperationName":  {
                                                                "type":  "string"
                                                            },
                                                            "Category":  {
                                                                "type":  "string"
                                                            },
                                                            "AppName":  {
                                                                "type":  "string"
                                                            },
                                                            "Type":  {
                                                                "type":  "string"
                                                            },
                                                            "Result":  {
                                                                "type":  "string"
                                                            }
                                                        },
                                                        "required":  [
                                                            "UserName",
                                                            "OperationName",
                                                            "Category",
                                                            "AppName",
                                                            "Type",
                                                            "Result"
                                                        ]
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    "runAfter":  {
                                        "Audit_Logs":  [
                                            "Succeeded"
                                        ]
                                    },
                                    "else":  {
                                        "actions":  {
                                        }
                                    },
                                    "expression":  {
                                        "and":  [
                                            {
                                                "greater":  [
                                                    "@length(body('Audit_Logs')?['value'])",
                                                    0
                                                ]
                                            }
                                        ]
                                    },
                                    "type":  "If"
                                }
                            },
                            "runAfter":  {
                                "Audit_Logs_table":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "Foreach"
                        },
                        "No_Sign_In":  {
                            "runAfter":  {
                                "Sign_in":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "No_Sign_in",
                                        "type":  "string",
                                        "value":  "\u003ctable style=\"border: 1px solid black; border-collapse: collapse; display: inline-table; width: auto;\"\u003e\u003ctr style=\"border: 1px solid black;\"\u003e\u003cth style=\"border: 1px solid black;\"\u003eAccount\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eIP Address\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eSign_In\u003c/th\u003e\u003c/tr\u003e"
                                    }
                                ]
                            }
                        },
                        "Add_comment_to_incident_(V3)_1-copy":  {
                            "runAfter":  {
                                "Add_comment_to_incident_(V3)_1":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "ApiConnection",
                            "inputs":  {
                                "host":  {
                                    "connection":  {
                                        "name":  "@parameters('$connections')['azuresentinel-2']['connectionId']"
                                    }
                                },
                                "method":  "post",
                                "body":  {
                                    "incidentArmId":  "@triggerBody()?['object']?['id']",
                                    "message":  "\u003cp class=\"editor-paragraph\"\u003eNo Sign ins observed from Account, IP.\u003c/p\u003e\u003cp class=\"editor-paragraph\"\u003e@{variables('No_Sign_in')}\u003c/p\u003e"
                                },
                                "path":  "/Incidents/Comment"
                            }
                        },
                        "Add_comment_to_incident_(V3)_1":  {
                            "runAfter":  {
                                "For_each_1":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "ApiConnection",
                            "inputs":  {
                                "host":  {
                                    "connection":  {
                                        "name":  "@parameters('$connections')['azuresentinel-2']['connectionId']"
                                    }
                                },
                                "method":  "post",
                                "body":  {
                                    "incidentArmId":  "@triggerBody()?['object']?['id']",
                                    "message":  "\u003cp class=\"editor-paragraph\"\u003eBelow are the Sign in logs assocaited with account with respective IP.\u003c/p\u003e\u003cp class=\"editor-paragraph\"\u003e@{join(union(split(variables('Sign_in'), '\u003ctr\u003e'), split(variables('Sign_in'), '\u003ctr\u003e')), '\u003ctr\u003e')}\u003c/p\u003e"
                                },
                                "path":  "/Incidents/Comment"
                            }
                        },
                        "Add_comment_to_incident_(V3)_3-copy_1":  {
                            "runAfter":  {
                                "Add_comment_to_incident_(V3)_1-copy":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "ApiConnection",
                            "inputs":  {
                                "host":  {
                                    "connection":  {
                                        "name":  "@parameters('$connections')['azuresentinel-2']['connectionId']"
                                    }
                                },
                                "method":  "post",
                                "body":  {
                                    "incidentArmId":  "@triggerBody()?['object']?['id']",
                                    "message":  "\u003cp class=\"editor-paragraph\"\u003eBelow table is from Audit Logs :\u003c/p\u003e\u003cp class=\"editor-paragraph\"\u003e@{join(union(split(variables('Audit Logs'), '\u003ctr\u003e'), split(variables('Audit Logs'), '\u003ctr\u003e')), '\u003ctr\u003e')}\u003cbr\u003e\u003c/p\u003e\u003cbr\u003e"
                                },
                                "path":  "/Incidents/Comment"
                            }
                        },
                        "Audit_Logs_table":  {
                            "runAfter":  {
                                "No_Sign_In":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "Audit Logs",
                                        "type":  "string",
                                        "value":  "\u003ctable style=\"border: 1px solid black; border-collapse: collapse; display: inline-table; width: auto;\"\u003e\u003ctr style=\"border: 1px solid black;\"\u003e\u003cth style=\"border: 1px solid black;\"\u003eUser Name\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eOperation Name\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eCategory\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eApp Name\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eType\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eResult\u003c/th\u003e\u003c/tr\u003e"
                                    }
                                ]
                            }
                        }
                    },
                    "outputs":  {
                    }
                },
                "parameters":  {
                    "$connections":  {
                        "value":  {
                            "azuresentinel":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]",
                                "connectionName":  "[variables('MicrosoftSentinelConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel')]",
                                "connectionProperties":  {
                                    "authentication":  {
                                        "type":  "ManagedServiceIdentity"
                                    }
                                }
                            },
                            "azuresentinel-1":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('Azuresentinel-1ConnectionName'))]",
                                "connectionName":  "[variables('Azuresentinel-1ConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel-1')]"
                            },
                            "outlook":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('OutlookConnectionName'))]",
                                "connectionName":  "[variables('OutlookConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Outlook')]"
                            },
                            "azuresentinel-2":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('Azuresentinel-2ConnectionName'))]",
                                "connectionName":  "[variables('Azuresentinel-2ConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel-2')]"
                            },
                            "azuremonitorlogs":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('AzuremonitorlogsConnectionName'))]",
                                "connectionName":  "[variables('AzuremonitorlogsConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuremonitorlogs')]"
                            }
                        }
                    }
                }
            },
            "name":  "[parameters('PlaybookName')]",
            "type":  "Microsoft.Logic/workflows",
            "location":  "[resourceGroup().location]",
            "tags":  {
                "hidden-SentinelTemplateName":  "First_Access_Credential",
                "hidden-SentinelTemplateVersion":  "1.0"
            },
            "identity":  {
                "type":  "SystemAssigned"
            },
            "apiVersion":  "2017-07-01",
            "dependsOn":  [
                "[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('Azuresentinel-1ConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('OutlookConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('Azuresentinel-2ConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('AzuremonitorlogsConnectionName'))]"
            ]
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('MicrosoftSentinelConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('MicrosoftSentinelConnectionName')]",
                "customParameterValues":  {
                },
                "parameterValueType":  "Alternative",
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel')]"
                }
            }
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('Azuresentinel-1ConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('Azuresentinel-1ConnectionName')]",
                "customParameterValues":  {
                },
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel-1')]"
                }
            }
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('OutlookConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('OutlookConnectionName')]",
                "customParameterValues":  {
                },
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Outlook')]"
                }
            }
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('Azuresentinel-2ConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('Azuresentinel-2ConnectionName')]",
                "customParameterValues":  {
                },
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel-2')]"
                }
            }
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('AzuremonitorlogsConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('AzuremonitorlogsConnectionName')]",
                "customParameterValues":  {
                },
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuremonitorlogs')]"
                }
            }
        }
    ]
}
